{
    "package": "unbound",
    "version": "1.23.0",
    "type": "host",
    "download": {
        "kind": "tar.gz",
        "sha256": "959bd5f3875316d7b3f67ee237a56de5565f5b35fc9b5fc3cea6cfe735a03bb8",
        "url": "http://www.nlnetlabs.nl/downloads/unbound/unbound-1.23.0.tar.gz"
    },
    "dependencies": [
        "*-android*:native/android_ndk",
        "all:native/autoconf",
        "all:native/m4",
        "all:native/perl",
        "all:expat",
        "all:openssl"
    ],
    "patches": [
        "disable-glibc-reallocarray.patch"
    ],
    "build": {
        "env": [
            "all:BUILD_HOST=$HOST",
            "aarch64-apple-ios-simulator:BUILD_HOST=aarch64-apple-ios",
            "all:config_opts=--disable-shared --enable-static --without-pyunbound --prefix=$PREFIX --host=$BUILD_HOST",
            "all:config_opts=$config_opts --with-libexpat=$PREFIX --with-ssl=$PREFIX --with-libevent=no",
            "all:config_opts=$config_opts --without-pythonmodule --disable-flto --with-pthreads --with-libunbound-only",
            "*-linux-*:config_opts=$config_opts --with-pic",
            "*-w64-*:config_opts=$config_opts --enable-static-exe --sysconfdir=/etc --prefix=$PREFIX --target=$PREFIX",
            "x86_64-apple-darwin:config_opts=$config_opts ac_cv_func_SHA384_Init=yes",
            "*-linux-android*:config_opts=$config_opts ac_cv_type_pthread_spinlock_t=no",
            "*-w64-mingw32:build_opts=$build_opts LDFLAGS=\"$LDFLAGS -lpthread\"",
            "*-w64-mingw32:CFLAGS=$CFLAGS -D_WIN32_WINNT=0x600",
            "all:config_opts=$config_opts ac_cv_func_getentropy=no"
        ],
        "steps": [
            "all:patch -p1 < $PATCH_DIR/unbound/disable-glibc-reallocarray.patch",
            "all:autoconf",
            "all:./configure $config_opts",
            "all:make -j$NUM_CORES $build_opts",
            "all:make -j$NUM_CORES DESTDIR=$STAGING_DIR install"
        ]
    }
}